<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<meta property="og:type" content="website">
<meta property="og:title" content="ê¹€ë…•í˜ì´">
<meta property="og:description" content="íƒ„ì†Œì¤‘ë¦½ ì‹¤ì²œ ë° í”Œë¡œê¹… í™œë™ìœ¼ë¡œ ë‚˜ë§Œì˜ ì—ì½” í¬ì¸íŠ¸ë¥¼ ìŒ“ì•„ë³´ì„¸ìš”. ğŸŒ±">
<meta property="og:image" content="/og-image.png">

<title>ê¹€ë…•í˜ì´</title>
<style>
    body { margin:0; padding:0; overflow:hidden; background:#f7fbfc; }
    iframe { position:absolute; top:0; left:0; width:100%; height:100%; border:none; }
</style>
<script>
    // â˜… GAS ë°°í¬ ì£¼ì†Œ (ì—¬ê¸°ë¥¼ ì‚¬ì¥ë‹˜ ì£¼ì†Œë¡œ ê¼­ í™•ì¸í•˜ì„¸ìš”)
    const gasUrl = "https://script.google.com/macros/s/AKfycbytgcHHzaZTkp6e1XWBXBVNVFRE8bzgE2i6EI9N3k3Vv0FAyCmv9sfDa1_o212bd94U/exec";

    // 1. ìì‹(GAS)ì´ ë³´ë‚´ëŠ” ì‹ í˜¸ ìˆ˜ì‹ 
// [Vercel ë¶€ëª¨ ì½”ë“œ ë‚´ ë¦¬ìŠ¤ë„ˆ ìˆ˜ì •]
window.addEventListener('message', function(e) {
    // ë³´ì•ˆ ì—ëŸ¬ ë°©ì§€: ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¬´ì‹œ
    if (!e.data) return;

    // ë§Œì•½ ë°ì´í„°ê°€ ë¬¸ìì—´ë¡œ ì™”ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„ (JSON íŒŒì‹±)
    let data = e.data;
    if (typeof data === 'string') {
        try { data = JSON.parse(data); } catch(err) { return; }
    }

    if (data.type === 'OPEN_LOGIN') {
        console.log("ë¶€ëª¨ê°€ ì‹ í˜¸ ìˆ˜ì‹ í•¨: íŒì—… ì‹¤í–‰");
        const w = 450, h = 650;
        const left = (window.screen.width / 2) - (w / 2);
        const top = (window.screen.height / 2) - (h / 2);
        
        let popup = window.open(gasUrl + "?page=login_popup", "LoginPopup", `width=${w},height=${h},top=${top},left=${left}`);
        
        if(!popup) {
            alert("íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì£¼ì†Œì°½ì˜ íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ì£¼ì„¸ìš”.");
            return;
        }

        let timer = setInterval(function() { 
            if(popup.closed) {
                clearInterval(timer);
                // ê°•ì œ ìƒˆë¡œê³ ì¹¨ (íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€)
                document.getElementById('appFrame').src = gasUrl + "?t=" + new Date().getTime();
            }
        }, 500);
    }
});

    // 2. ì´ˆê¸° ì‹¤í–‰
    window.onload = function() {
        let iframe = document.createElement('iframe');
        iframe.id = 'appFrame';
        iframe.src = gasUrl;
        
        // â˜… allow-popups: ì´ê²Œ ìˆì–´ì•¼ íŒì—…ì´ ëœ¹ë‹ˆë‹¤.
        iframe.allow = "camera; microphone; clipboard-write";
        iframe.setAttribute("sandbox", "allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-storage-access-by-user-activation allow-modals allow-top-navigation");
        
        document.body.appendChild(iframe);
    }
</script>
</head>
<body></body>
</html>


